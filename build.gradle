import org.gradle.plugins.signing.Sign

buildscript {
    dependencies {
        classpath 'com.adaptc.gradle:nexus-workflow:0.6'
        classpath 'com.jfrog.bintray.gradle:gradle-bintray-plugin:1.8.4'
    }
}

plugins {
    id 'pl.allegro.tech.build.axion-release' version '1.8.1'
    id 'signing'
    id 'maven'
}

apply plugin: 'nexus-workflow'
apply plugin: "com.jfrog.bintray"

allprojects {
    project.version = scmVersion.version
    apply plugin: 'maven'
}

apply plugin: 'java'
apply plugin: 'idea'
repositories {
    mavenCentral()
}
dependencies {
    implementation 'org.hibernate:hibernate-core:5.1.13.Final'
}

// signing {
//     sign configurations.archives
// }

uploadArchives {
    configuration = configurations.archives
    doFirst {
        repositories.mavenDeployer {
            snapshotRepository(url: 'https://oss.sonatype.org/content/repositories/snapshots/') {
                authentication(userName: sonatypeUsername, password: sonatypePassword)
            }
        }
    }
}

bintray {
    user = findProperty("bintrayUser")
    key = findProperty("bintrayApiKey")

    dryRun = (findProperty('dryRun') ?: 'true').toBoolean()
    configurations = ['archives']
    pkg {
        repo = 'maven'
        name = 'rundeck-oracle-dialect'
        userOrg = 'rundeck'
    }
}